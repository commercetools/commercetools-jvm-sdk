<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TaxMode (Composable Commerce JVM SDK 2.11.0-SNAPSHOT API)</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TaxMode (Composable Commerce JVM SDK 2.11.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TaxMode.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../io/sphere/sdk/carts/TaxedPrice.html" title="interface in io.sphere.sdk.carts"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../io/sphere/sdk/carts/TaxPortion.html" title="interface in io.sphere.sdk.carts"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?io/sphere/sdk/carts/TaxMode.html" target="_top">Frames</a></li>
<li><a href="TaxMode.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#enum.constant.summary">Enum Constants</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#enum.constant.detail">Enum Constants</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.sphere.sdk.carts</div>
<h2 title="Enum TaxMode" class="title">Enum TaxMode</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true" title="class or interface in java.lang">java.lang.Enum</a>&lt;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a>&gt;</li>
<li>
<ul class="inheritance">
<li>io.sphere.sdk.carts.TaxMode</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../io/sphere/sdk/models/SphereEnumeration.html" title="interface in io.sphere.sdk.models">SphereEnumeration</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html?is-external=true" title="class or interface in java.lang">Comparable</a>&lt;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a>&gt;</dd>
</dl>
<hr>
<br>
<pre>public enum <span class="typeNameLabel">TaxMode</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true" title="class or interface in java.lang">Enum</a>&lt;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a>&gt;
implements <a href="../../../../io/sphere/sdk/models/SphereEnumeration.html" title="interface in io.sphere.sdk.models">SphereEnumeration</a></pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== ENUM CONSTANT SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="enum.constant.summary">
<!--   -->
</a>
<h3>Enum Constant Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Enum Constant Summary table, listing enum constants, and an explanation">
<caption><span>Enum Constants</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Enum Constant and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../io/sphere/sdk/carts/TaxMode.html#DISABLED">DISABLED</a></span></code>
<div class="block">No taxes are added to the cart.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../io/sphere/sdk/carts/TaxMode.html#EXTERNAL">EXTERNAL</a></span></code>
<div class="block">The tax rates are set externally.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../io/sphere/sdk/carts/TaxMode.html#EXTERNAL_AMOUNT">EXTERNAL_AMOUNT</a></span></code>
<div class="block">The tax amounts and the tax rates as well as the tax portions are set externally per <a href="../../../../io/sphere/sdk/carts/ExternalTaxAmountDraft.html" title="interface in io.sphere.sdk.carts"><code>ExternalTaxAmountDraft</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../io/sphere/sdk/carts/TaxMode.html#PLATFORM">PLATFORM</a></span></code>
<div class="block">The tax rates are selected by the system from the <a href="../../../../io/sphere/sdk/taxcategories/TaxCategory.html" title="interface in io.sphere.sdk.taxcategories"><code>tax categories</code></a> based on the cart shipping address.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../io/sphere/sdk/carts/TaxMode.html#ofSphereValue-java.lang.String-">ofSphereValue</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;value)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static <a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../io/sphere/sdk/carts/TaxMode.html#valueOf-java.lang.String-">valueOf</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;name)</code>
<div class="block">Returns the enum constant of this type with the specified name.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static <a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a>[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../io/sphere/sdk/carts/TaxMode.html#values--">values</a></span>()</code>
<div class="block">Returns an array containing the constants of this enum type, in
the order they are declared.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Enum">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true" title="class or interface in java.lang">Enum</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#compareTo-E-" title="class or interface in java.lang">compareTo</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#getDeclaringClass--" title="class or interface in java.lang">getDeclaringClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#name--" title="class or interface in java.lang">name</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#ordinal--" title="class or interface in java.lang">ordinal</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Enum.html?is-external=true#valueOf-java.lang.Class-java.lang.String-" title="class or interface in java.lang">valueOf</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.io.sphere.sdk.models.SphereEnumeration">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;io.sphere.sdk.models.<a href="../../../../io/sphere/sdk/models/SphereEnumeration.html" title="interface in io.sphere.sdk.models">SphereEnumeration</a></h3>
<code><a href="../../../../io/sphere/sdk/models/SphereEnumeration.html#findBySphereName-T:A-java.lang.String-">findBySphereName</a>, <a href="../../../../io/sphere/sdk/models/SphereEnumeration.html#name--">name</a>, <a href="../../../../io/sphere/sdk/models/SphereEnumeration.html#toSphereName--">toSphereName</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ ENUM CONSTANT DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="enum.constant.detail">
<!--   -->
</a>
<h3>Enum Constant Detail</h3>
<a name="PLATFORM">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PLATFORM</h4>
<pre>public static final&nbsp;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a> PLATFORM</pre>
<div class="block">The tax rates are selected by the system from the <a href="../../../../io/sphere/sdk/taxcategories/TaxCategory.html" title="interface in io.sphere.sdk.taxcategories"><code>tax categories</code></a> based on the cart shipping address.</div>
</li>
</ul>
<a name="EXTERNAL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EXTERNAL</h4>
<pre>public static final&nbsp;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a> EXTERNAL</pre>
<div class="block">The tax rates are set externally. A cart with this tax mode can only be ordered if all line items, all custom line items and the shipping method have an external tax rate set.

 <h3 id="create-cart-with-external-tax-mode">Create a cart with external tax mode</h3>

 <p>Cart creation with line item</p>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-createCartWithALineItemWithAnExternalTaxRate--%s" class=code-example><pre><code class='java'>withProductOfPrices(client(), singletonList(PriceDraft.of(EURO_10)), (Product product) -&gt; {
    final String taxRateName = "special tax";
    final double rate = 0.20;
    final ExternalTaxRateDraft externalTaxRate =
            ExternalTaxRateDraftBuilder.ofAmount(rate, taxRateName, DE).build();
    final int quantity = 22;
    final int variantId = 1;
    final LineItemDraft itemDraft = LineItemDraft.of(product, variantId, quantity)
            .withExternalTaxRate(externalTaxRate);
    final CartDraftDsl cartDraft = CartDraft.of(EUR)
            .withTaxMode(TaxMode.EXTERNAL)//important
            .withCountry(DE)
            .withShippingAddress(Address.of(DE))
            .withLineItems(singletonList(itemDraft));
    final CartCreateCommand cmd = CartCreateCommand.of(cartDraft);

    final Cart cart = client().executeBlocking(cmd);

    assertThat(cart.getTaxMode()).isEqualTo(TaxMode.EXTERNAL);
    final LineItem lineItem = cart.getLineItems().get(0);

    softAssert(s -&gt; {
        final TaxRate taxRate = lineItem.getTaxRate();
        s.assertThat(taxRate.getName()).isEqualTo(taxRateName);
        s.assertThat(taxRate.getAmount()).isEqualTo(rate);
        s.assertThat(taxRate.getCountry()).isEqualTo(DE);
        s.assertThat(taxRate.getId()).as("tax rate id").isNull();
        s.assertThat(taxRate.getSubRates()).as("sub rates").isEmpty();
        s.assertThat(lineItem.getTotalPrice()).as("lineItem totalPrice").isEqualTo(MoneyImpl.of(220, EUR));
        s.assertThat(cart.getTotalPrice()).as("cart totalPrice").isEqualTo(MoneyImpl.of(220, EUR));
        final TaxedPrice taxedPrice = cart.getTaxedPrice();
        s.assertThat(taxedPrice.getTotalGross()).as("gross").isEqualTo(MoneyImpl.of(264, EUR));
        s.assertThat(taxedPrice.getTotalNet()).as("net").isEqualTo(MoneyImpl.of(220, EUR));
    });
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>Create empty cart</p>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-createEmptyCart--%s" class=code-example><pre><code class='java'>final CartDraftDsl cartDraft = CartDraft.of(EUR)
        .withTaxMode(TaxMode.EXTERNAL);//important

final Cart cart = client().executeBlocking(CartCreateCommand.of(cartDraft));

assertThat(cart.getTaxMode()).isEqualTo(TaxMode.EXTERNAL);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="add-line-item-with-external-tax-mode">Add a LineItem with an external tax rate</h3>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-addLineItem--%s" class=code-example><pre><code class='java'>withProductOfPrices(client(), singletonList(PriceDraft.of(EURO_10)), (Product product) -&gt; {
    final CartDraft draft = CartDraft.of(EUR).withTaxMode(TaxMode.EXTERNAL);
    withCartDraft(client(), draft, (Cart cart) -&gt; {
        final int quantity = 3;
        final int variantId = product.getMasterData().getStaged().getMasterVariant().getId();
        final String taxRateName = "special tax";
        final double rate = 0.20;
        final List&lt;SubRate&gt; subRates = asList(SubRate.of("foo", 0.11), SubRate.of("bar", 0.09));
        final ExternalTaxRateDraft externalTaxRate =
                ExternalTaxRateDraftBuilder.ofAmount(rate, taxRateName, DE)
                        .subRates(subRates)
                        .build();
        final AddLineItem updateAction = AddLineItem.of(product, variantId, quantity)
                .withExternalTaxRate(externalTaxRate);
        final Cart cartWithLineItem = client().executeBlocking(CartUpdateCommand.of(cart, updateAction));

        final LineItem lineItem = cartWithLineItem.getLineItems().get(0);
        final TaxRate taxRate = lineItem.getTaxRate();
        assertThat(taxRate.getSubRates()).isEqualTo(subRates);
        assertThat(taxRate.getCountry()).isEqualTo(DE);
        assertThat(taxRate.getId()).isNull();
        assertThat(taxRate.getName()).isEqualTo(taxRateName);
        assertThat(taxRate.getAmount()).isEqualTo(0.2);
        assertThat(taxRate.isIncludedInPrice()).isFalse();
        assertThat(lineItem.getTotalPrice()).isEqualTo(MoneyImpl.ofCents(3000, "EUR"));
        assertThat(lineItem.getTaxedPrice().getTotalNet()).isEqualTo(MoneyImpl.ofCents(3000, "EUR"));
        assertThat(lineItem.getTaxedPrice().getTotalGross()).isEqualTo(MoneyImpl.ofCents(3600, "EUR"));

        return cartWithLineItem;
    });
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>Error case when the cart does not have the external tax but a line item is added</p>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-addLineItemOnPlatformCart--%s" class=code-example><pre><code class='java'>withProductOfPrices(client(), singletonList(PriceDraft.of(EURO_10)), (Product product) -&gt; {
    final CartDraft draft = CartDraft.of(EUR); // Uses the Platform TaxMode by default
    withCartDraft(client(), draft, (Cart cart) -&gt; {
        final int quantity = 3;
        final int variantId = product.getMasterData().getStaged().getMasterVariant().getId();
        final String taxRateName = "special tax";
        final double taxRate = 0.20;
        final List&lt;SubRate&gt; subRates = asList(SubRate.of("foo", 0.11), SubRate.of("bar", 0.09));
        final ExternalTaxRateDraft externalTaxRate =
                ExternalTaxRateDraftBuilder.ofAmount(taxRate, taxRateName, DE)
                        .subRates(subRates)
                        .build();
        final AddLineItem updateAction = AddLineItem.of(product, variantId, quantity)
                .withExternalTaxRate(externalTaxRate);

        final Throwable throwable = catchThrowable(() -&gt; client().executeBlocking(CartUpdateCommand.of(cart, updateAction)));

        //the error message is sth. like "Cannot set an external tax rate on a cart with taxMode 'Platform'."
        assertThat(throwable).isInstanceOf(ErrorResponseException.class);

        return cart;
    });
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="add-line-item-with-delayed-external-tax-rate">Add a LineItem and add the external tax rate later</h3>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-setLineItemTaxRate--%s" class=code-example><pre><code class='java'>withProductOfPrices(client(), singletonList(PriceDraft.of(EURO_10)), (Product product) -&gt; {
    final CartDraft draft = CartDraft.of(EUR).withTaxMode(TaxMode.EXTERNAL);
    withCartDraft(client(), draft, (Cart cart) -&gt; {
        final int quantity = 3;
        final int variantId = product.getMasterData().getStaged().getMasterVariant().getId();
        final AddLineItem updateAction = AddLineItem.of(product, variantId, quantity);
        final Cart cartWithLineItem = client().executeBlocking(CartUpdateCommand.of(cart, updateAction));

        final LineItem lineItem = cartWithLineItem.getLineItems().get(0);
        assertThat(lineItem.getTaxRate()).isNull();
        assertThat(lineItem.getTotalPrice()).isEqualTo(EURO_30);
        assertThat(lineItem.getTaxedPrice()).isNull();

        //now add the taxes
        final String taxRateName = "special tax";
        final double taxRate = 0.20;
        final ExternalTaxRateDraft externalTaxRate =
                ExternalTaxRateDraftBuilder.ofAmount(taxRate, taxRateName, DE).includedInPrice(false).build();

        final SetLineItemTaxRate setLineItemTaxRate = SetLineItemTaxRate.of(lineItem.getId(), externalTaxRate);
        final Cart cartWithTaxedLineItem =
                client().executeBlocking(CartUpdateCommand.of(cartWithLineItem, setLineItemTaxRate));

        final LineItem taxedLineItem = cartWithTaxedLineItem.getLineItems().get(0);
        assertThat(taxedLineItem.getTaxRate().getName()).isEqualTo(taxRateName);
        assertThat(taxedLineItem.getTaxRate().isIncludedInPrice()).isEqualTo(false);
        assertThat(taxedLineItem.getTotalPrice()).isEqualTo(EURO_30);
        assertThat(taxedLineItem.getTaxedPrice().getTotalGross()).isEqualTo(EURO_36);
        assertThat(taxedLineItem.getTaxedPrice().getTotalNet()).isEqualTo(EURO_30);

        return cartWithTaxedLineItem;
    });
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="add-custom-line-item-with-external-tax-mode">Add a CustomLineItem with an external tax rate</h3>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-addCustomLineItem--%s" class=code-example><pre><code class='java'>final CartDraft draft = CartDraft.of(EUR)
        .withTaxMode(TaxMode.EXTERNAL)
        .withShippingAddress(Address.of(DE));
withCartDraft(client(), draft, (Cart cart) -&gt; {
    final MonetaryAmount money = MoneyImpl.of("23.50", EUR);
    final String slug = "thing-slug";
    final LocalizedString name = en("thing");
    final long quantity = 5;
    final String taxRateName = "special tax";
    final double taxRate = 0.20;
    final ExternalTaxRateDraft externalTaxRate =
            ExternalTaxRateDraftBuilder.ofAmount(taxRate, taxRateName, DE).build();
    final CustomLineItemDraft item = CustomLineItemDraft.ofExternalTaxCalculation(name, slug, money, externalTaxRate, quantity);

    final Cart cartWithCustomLineItems = client().executeBlocking(CartUpdateCommand.of(cart, AddCustomLineItem.of(item)));
    assertThat(cartWithCustomLineItems.getCustomLineItems()).hasSize(1);
    final CustomLineItem customLineItem = cartWithCustomLineItems.getCustomLineItems().get(0);

    assertThat(customLineItem.getTaxCategory()).isNull();
    assertThat(customLineItem.getTaxedPrice().getTotalNet()).isEqualTo(MoneyImpl.of("117.50", EUR));
    assertThat(customLineItem.getTaxedPrice().getTotalGross()).isEqualTo(MoneyImpl.of("141.00", EUR));
    assertThat(customLineItem.getTaxRate().getName()).isEqualTo(taxRateName);

    return cartWithCustomLineItems;
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="add-line-item-with-delayed-external-tax-rate">Add a CustomLineItem and add the external tax rate later</h3>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-setCustomLineItemTaxRate--%s" class=code-example><pre><code class='java'>final CartDraft draft = CartDraft.of(EUR)
        .withTaxMode(TaxMode.EXTERNAL)
        .withShippingAddress(Address.of(DE));
withCartDraft(client(), draft, (Cart cart) -&gt; {
    final MonetaryAmount money = MoneyImpl.of("23.50", EUR);
    final String slug = "thing-slug";
    final LocalizedString name = en("thing");
    final long quantity = 5;
    final CustomLineItemDraft item = CustomLineItemDraft.ofExternalTaxCalculation(name, slug, money, quantity);

    final Cart cartWithCustomLineItem = client().executeBlocking(CartUpdateCommand.of(cart, AddCustomLineItem.of(item)));
    assertThat(cartWithCustomLineItem.getCustomLineItems()).hasSize(1);
    final CustomLineItem customLineItem = cartWithCustomLineItem.getCustomLineItems().get(0);

    assertThat(customLineItem.getTaxCategory()).isNull();
    assertThat(customLineItem.getTaxedPrice()).isNull();
    assertThat(customLineItem.getTaxRate())
            .as("custom line item does not have tax information yet")
            .isNull();

    final String taxRateName = "special tax";
    final double taxRate = 0.20;
    final ExternalTaxRateDraft externalTaxRate =
            ExternalTaxRateDraftBuilder.ofAmount(taxRate, taxRateName, DE).build();

    final SetCustomLineItemTaxRate updateAction = SetCustomLineItemTaxRate.of(customLineItem.getId(), externalTaxRate);
    final Cart cartWithTaxedLineItem = client().executeBlocking(CartUpdateCommand.of(cartWithCustomLineItem, updateAction));

    final CustomLineItem taxedCustomLineItem = cartWithTaxedLineItem.getCustomLineItems().get(0);
    assertThat(taxedCustomLineItem.getTaxCategory()).isNull();
    assertThat(taxedCustomLineItem.getTaxedPrice().getTotalNet()).isEqualTo(MoneyImpl.of("117.50", EUR));
    assertThat(taxedCustomLineItem.getTaxedPrice().getTotalGross()).isEqualTo(MoneyImpl.of("141.00", EUR));
    assertThat(taxedCustomLineItem.getTaxRate().getName()).isEqualTo(taxRateName);

    return cartWithTaxedLineItem;
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="add-custom-shipping-method-with-external-tax-mode">Add a custom shipping method with an external tax rate</h3>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-addCustomShippingMethod--%s" class=code-example><pre><code class='java'>final CartDraft draft = CartDraft.of(EUR)
        .withTaxMode(TaxMode.EXTERNAL)
        .withShippingAddress(Address.of(DE));
withCartDraft(client(), draft, (Cart cart) -&gt; {
    final String taxRateName = "special tax";
    final double taxRate = 0.20;
    final ExternalTaxRateDraft externalTaxRate =
            ExternalTaxRateDraftBuilder.ofAmount(taxRate, taxRateName, DE).build();
    final ShippingRate shippingRate = ShippingRate.of(EURO_10,null, Collections.emptyList());
    final SetCustomShippingMethod action =
            SetCustomShippingMethod.ofExternalTaxCalculation("name", shippingRate, externalTaxRate);

    final Cart cartWithShippingMethod = client().executeBlocking(CartUpdateCommand.of(cart, action));

    final CartShippingInfo shippingInfo = cartWithShippingMethod.getShippingInfo();
    assertThat(shippingInfo).isNotNull();
    assertThat(shippingInfo.getShippingRate()).isEqualTo(shippingRate);
    assertThat(shippingInfo.getTaxCategory()).isNull();
    assertThat(shippingInfo.getTaxedPrice().getTotalNet()).isEqualTo(EURO_10);
    assertThat(shippingInfo.getTaxedPrice().getTotalGross()).isEqualTo(EURO_12);
    assertThat(shippingInfo.getTaxRate().getName()).isEqualTo(taxRateName);

    return cartWithShippingMethod;
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="add-custom-shipping-method-with-delayed-external-tax-mode">Add a custom shipping method and add the external tax rate later</h3>

 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-setShippingMethodTaxRate--%s" class=code-example><pre><code class='java'>final CartDraft draft = CartDraft.of(EUR)
        .withTaxMode(TaxMode.EXTERNAL)
        .withShippingAddress(Address.of(DE));
withCartDraft(client(), draft, (Cart cart) -&gt; {
    final ShippingRate shippingRate = ShippingRate.of(EURO_10,null, Collections.emptyList());
    final SetCustomShippingMethod action =
            SetCustomShippingMethod.ofExternalTaxCalculation("name", shippingRate);

    final Cart cartWithShippingMethod = client().executeBlocking(CartUpdateCommand.of(cart, action));

    final CartShippingInfo shippingInfo = cartWithShippingMethod.getShippingInfo();
    assertThat(shippingInfo).isNotNull();
    assertThat(shippingInfo.getShippingRate()).isEqualTo(shippingRate);
    assertThat(shippingInfo.getTaxCategory()).isNull();
    assertThat(shippingInfo.getTaxedPrice()).isNull();
    assertThat(shippingInfo.getTaxRate()).isNull();


    final String taxRateName = "special tax";
    final double taxRate = 0.20;
    final ExternalTaxRateDraft externalTaxRate =
            ExternalTaxRateDraftBuilder.ofAmount(taxRate, taxRateName, DE).build();

    final CartUpdateCommand cmd =
            CartUpdateCommand.of(cartWithShippingMethod, SetShippingMethodTaxRate.of(externalTaxRate));
    final Cart cartWithTaxedShippingMethod = client().executeBlocking(cmd);

    final CartShippingInfo taxedShippingInfo = cartWithTaxedShippingMethod.getShippingInfo();
    assertThat(taxedShippingInfo).isNotNull();
    assertThat(taxedShippingInfo.getShippingRate()).isEqualTo(shippingRate);
    assertThat(taxedShippingInfo.getTaxCategory()).isNull();
    assertThat(taxedShippingInfo.getTaxedPrice().getTotalNet()).isEqualTo(EURO_10);
    assertThat(taxedShippingInfo.getTaxedPrice().getTotalGross()).isEqualTo(EURO_12);
    assertThat(taxedShippingInfo.getTaxRate().getName()).isEqualTo(taxRateName);

    return cartWithTaxedShippingMethod;
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="change-the-tax-mode-of-a-cart">Change the tax mode of a cart</h3>
 <p>Example</p>
 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-changeTaxMode--%s" class=code-example><pre><code class='java'>final CartDraftDsl cartDraft = CartDraft.of(EUR)
        .withTaxMode(TaxMode.EXTERNAL);//important

final Cart externalTaxModeCart = client().executeBlocking(CartCreateCommand.of(cartDraft));

assertThat(externalTaxModeCart.getTaxMode()).isEqualTo(TaxMode.EXTERNAL);

final Cart platformTaxModeCart =
        client().executeBlocking(CartUpdateCommand.of(externalTaxModeCart, ChangeTaxMode.of(TaxMode.PLATFORM)));

assertThat(platformTaxModeCart.getTaxMode()).isEqualTo(TaxMode.PLATFORM);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>It fails if the products does not have a tax category set</p>
 <div id="io-sphere-sdk-carts-ExternalTaxRatesIntegrationTest-errorMovingFromExternalToPlatformTaxMode--%s" class=code-example><pre><code class='java'>withProductOfPrices(client(), singletonList(PriceDraft.of(EURO_10)), (Product product) -&gt; {
    final CartDraft draft = CartDraft.of(EUR).withTaxMode(TaxMode.EXTERNAL);
    withCartDraft(client(), draft, (Cart cart) -&gt; {
        final int quantity = 3;
        final int variantId = product.getMasterData().getStaged().getMasterVariant().getId();
        final String taxRateName = "special tax";
        final double rate = 0.20;
        final List&lt;SubRate&gt; subRates = asList(SubRate.of("foo", 0.11), SubRate.of("bar", 0.09));
        final ExternalTaxRateDraft externalTaxRate =
                ExternalTaxRateDraftBuilder.ofAmount(rate, taxRateName, DE)
                        .subRates(subRates)
                        .build();
        final AddLineItem updateAction = AddLineItem.of(product, variantId, quantity)
                .withExternalTaxRate(externalTaxRate);
        final Cart cartWithLineItem = client().executeBlocking(CartUpdateCommand.of(cart, updateAction));

        final LineItem lineItem = cartWithLineItem.getLineItems().get(0);
        final TaxRate taxRate = lineItem.getTaxRate();
        assertThat(taxRate.getName()).isEqualTo(taxRateName);

        final CartUpdateCommand setTaxModeCmd =
                CartUpdateCommand.of(cartWithLineItem, ChangeTaxMode.of(TaxMode.PLATFORM));
        final Throwable throwable = catchThrowable(() -&gt; client().executeBlocking(setTaxModeCmd));

        assertThat(throwable)
                .as("it is not possible to change the cart to platform tax mode, " +
                        "if the product does not have a tax category")
                .isInstanceOf(ErrorResponseException.class);

        return cartWithLineItem;
    });
});
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/carts/ExternalTaxRatesIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>In case you use <a href="../../../../io/sphere/sdk/carts/CustomLineItem.html" title="interface in io.sphere.sdk.carts"><code>CustomLineItem</code></a>s as well as external and Composable Commerce tax mode, it is advised to
 add the tax category at the time of the creation of the custom line item if you don't know which tax mode will be used later.
 A cart with an external tax mode and a custom line item without a tax category cannot be transformed into a cart with 'Platform' mode tax calculation,
 to recover from this the custom object needs to be removed and added with a tax category.</p></div>
</li>
</ul>
<a name="EXTERNAL_AMOUNT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EXTERNAL_AMOUNT</h4>
<pre>public static final&nbsp;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a> EXTERNAL_AMOUNT</pre>
<div class="block">The tax amounts and the tax rates as well as the tax portions are set externally per <a href="../../../../io/sphere/sdk/carts/ExternalTaxAmountDraft.html" title="interface in io.sphere.sdk.carts"><code>ExternalTaxAmountDraft</code></a>.

 A cart with this tax mode can only be ordered if the cart itself and all line items,
 all custom line items and the shipping method have an external tax amount and rate set.</div>
</li>
</ul>
<a name="DISABLED">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DISABLED</h4>
<pre>public static final&nbsp;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a> DISABLED</pre>
<div class="block">No taxes are added to the cart.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="values--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>values</h4>
<pre>public static&nbsp;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a>[]&nbsp;values()</pre>
<div class="block">Returns an array containing the constants of this enum type, in
the order they are declared.  This method may be used to iterate
over the constants as follows:
<pre>
for (TaxMode c : TaxMode.values())
&nbsp;   System.out.println(c);
</pre></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>an array containing the constants of this enum type, in the order they are declared</dd>
</dl>
</li>
</ul>
<a name="valueOf-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>valueOf</h4>
<pre>public static&nbsp;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a>&nbsp;valueOf(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;name)</pre>
<div class="block">Returns the enum constant of this type with the specified name.
The string must match <i>exactly</i> an identifier used to declare an
enum constant in this type.  (Extraneous whitespace characters are 
not permitted.)</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>name</code> - the name of the enum constant to be returned.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the enum constant with the specified name</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if this enum type has no constant with the specified name</dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/NullPointerException.html?is-external=true" title="class or interface in java.lang">NullPointerException</a></code> - if the argument is null</dd>
</dl>
</li>
</ul>
<a name="ofSphereValue-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ofSphereValue</h4>
<pre>public static&nbsp;<a href="../../../../io/sphere/sdk/carts/TaxMode.html" title="enum in io.sphere.sdk.carts">TaxMode</a>&nbsp;ofSphereValue(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;value)</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TaxMode.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../io/sphere/sdk/carts/TaxedPrice.html" title="interface in io.sphere.sdk.carts"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../io/sphere/sdk/carts/TaxPortion.html" title="interface in io.sphere.sdk.carts"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?io/sphere/sdk/carts/TaxMode.html" target="_top">Frames</a></li>
<li><a href="TaxMode.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#enum.constant.summary">Enum Constants</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#enum.constant.detail">Enum Constants</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css'>                             <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js'></script>                             <script>hljs.initHighlightingOnLoad();</script>                             <script src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js'></script>                             <span id='custom-javascripts'></span>                             <script src='../../../../resources/javascripts/main.js'></script>                             <link rel='stylesheet' href='../../../../resources/stylesheets/main.css'></small></p>
</body>
</html>