<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>QueryDocumentation (commercetools JVM SDK 2.6.0 API)</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="QueryDocumentation (commercetools JVM SDK 2.6.0 API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/QueryDocumentation.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../io/sphere/sdk/meta/ProductAttributeDocumentation.html" title="class in io.sphere.sdk.meta"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../io/sphere/sdk/meta/ReferenceExpansionDocumentation.html" title="class in io.sphere.sdk.meta"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?io/sphere/sdk/meta/QueryDocumentation.html" target="_top">Frames</a></li>
<li><a href="QueryDocumentation.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#methods.inherited.from.class.io.sphere.sdk.models.Base">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li>Method</li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.sphere.sdk.meta</div>
<h2 title="Class QueryDocumentation" class="title">Class QueryDocumentation</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../io/sphere/sdk/models/Base.html" title="class in io.sphere.sdk.models">io.sphere.sdk.models.Base</a></li>
<li>
<ul class="inheritance">
<li>io.sphere.sdk.meta.QueryDocumentation</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public final class <span class="typeNameLabel">QueryDocumentation</span>
extends <a href="../../../../io/sphere/sdk/models/Base.html" title="class in io.sphere.sdk.models">Base</a></pre>
<div class="block"><p>The Query API is for reading specific resources from the platform.
 The resources can be sorted and fetched in batches.</p>

 <p>First, you need to specify a query, for example:</p>

 <div id="io-sphere-sdk-queries-QueryDemo-formulatingAQuery--%s" class=code-example><pre><code class='java'>Query&lt;Category&gt; query = CategoryQuery.of().byName(Locale.ENGLISH, "demo cat");
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/queries/QueryDemo.java" target="_blank">test code</a>.</pre></div>

 <p>Second, you use the sphere client to execute a query request, for example:</p>

 <div id="io-sphere-sdk-queries-QueryDemo-executeQuery--%s" class=code-example><pre><code class='java'>CompletionStage&lt;PagedQueryResult&lt;Category&gt;&gt; future = client.execute(query);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/queries/QueryDemo.java" target="_blank">test code</a>.</pre></div>

 <p>The successful execution of a <a href="../../../../io/sphere/sdk/queries/Query.html" title="interface in io.sphere.sdk.queries"><code>Query</code></a> results in <a href="../../../../io/sphere/sdk/queries/PagedQueryResult.html" title="interface in io.sphere.sdk.queries"><code>PagedQueryResult</code></a> of a platform resource or view.
 While the <a href="../../../../io/sphere/sdk/queries/Query.html" title="interface in io.sphere.sdk.queries"><code>Query</code></a> interface just contains information to execute a query,
 the interface <a href="../../../../io/sphere/sdk/queries/QueryDsl.html" title="interface in io.sphere.sdk.queries"><code>QueryDsl</code></a> also provides a domain specific language to tune a query.</p>

 <p>For most of the platform resources you can find classes to support you in formulating valid queries (in a sub package queries).</p>

 <p>The following snippet creates a query which selects all products without a specific order.</p>

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-queryForAllDemo--%s" class=code-example><pre><code class='java'>final ProductQuery query = ProductQuery.of();
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="creating-queries">Creating queries</h3>

  There are several ways to create a query:

  <ol>
      <li><a href="#create-query-with-model-companion-class">Create a query with helper methods from a model companion class</a></li>
      <li><a href="#create-query-with-predicates">Create a query with predicate API</a></li>
      <li><a href="#create-hard-coded-query">Create a hard coded query</a></li>
  </ol>

 <h4 id="create-query-with-model-companion-class">Create a query with helper methods from a model companion class</h4>

 <p>For some model interfaces companion classes exist (the name of the interface in plural) which provide some default queries, for example for categories:</p>

 <div id="io-sphere-sdk-queries-QueryDemo-queryFromCompanionHelper--%s" class=code-example><pre><code class='java'>Query&lt;Category&gt; queryById = CategoryQuery.of().byId("the-id");
Query&lt;Category&gt; queryBySlug = CategoryQuery.of().bySlug(Locale.ENGLISH, "category-slug");
Query&lt;Category&gt; queryByName = CategoryQuery.of().byName(Locale.ENGLISH, "demo cat");
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/queries/QueryDemo.java" target="_blank">test code</a>.</pre></div>


 <h4 id="create-query-with-predicates">Create a query with predicate API</h4>

 <p>There is a query model class for each queryable model interface, e.g., there is <code>io.sphere.sdk.categories.CategoryQueryModel</code> for <code>io.sphere.sdk.categories.Category</code>
, which contains a DSL to find and specify the queryable parameters.
 </p>

 <div id="io-sphere-sdk-queries-QueryDemo-categoryQueryModel--%s" class=code-example><pre><code class='java'>QueryPredicate&lt;Category&gt; predicate = CategoryQueryModel.of().name().lang(locale).is("demo cat");
Query&lt;Category&gt; query = CategoryQuery.of().withPredicates(predicate);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/queries/QueryDemo.java" target="_blank">test code</a>.</pre></div>

 <p>The generic code looks verbose, but in the future it will enable powerful type-safe queries with IDE discovery even on deep
 nested data structures like products. (coming soon)</p>

 The <a href="../../../../io/sphere/sdk/queries/QueryDsl.html" title="interface in io.sphere.sdk.queries"><code>QueryDsl</code></a> class, used by the query model classes, sorts by ID by default and it has no offset
 or limit specified. The following example shows how to specify sorting, limiting, and skipping pages.

 <div id="io-sphere-sdk-queries-QueryDemo-withPagination--%s" class=code-example><pre><code class='java'>QueryPredicate&lt;Category&gt; predicate = CategoryQueryModel.of().name().lang(locale).is("demo cat");

QuerySort&lt;Category&gt; sortByName = CategoryQueryModel.of().name().lang(locale).sort().desc();
QuerySort&lt;Category&gt; sortById = CategoryQueryModel.of().id().sort().asc();
List&lt;QuerySort&lt;Category&gt;&gt; sort = Arrays.asList(sortByName, sortById);//sort by name desc and then by ID if name is the same

long offset = 1;//skip first element - not page
long limit = 200;//collect at most 200 entities per request
Query&lt;Category&gt; query = CategoryQuery.of().
        withPredicates(predicate).
  withSort(sort).
  withOffset(offset).
  withLimit(limit);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/queries/QueryDemo.java" target="_blank">test code</a>.</pre></div>

 <a href="../../../../io/sphere/sdk/queries/QueryDsl.html" title="interface in io.sphere.sdk.queries"><code>QueryDsl</code></a> is an interface for immutable objects, so if you call <code>withXyz(value)</code>
 it returns a new immutable object:

 <div id="io-sphere-sdk-queries-QueryDemo-immutableQueryDsl--%s" class=code-example><pre><code class='java'>CategoryQuery query = CategoryQuery.of();
assertThat(query).isNotEqualTo(query.withLimit(30L));
assertThat(query.limit()).isEqualTo(Optional.empty());
assertThat(query.withLimit(30L).limit()).isEqualTo(Optional.of(30));
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/queries/QueryDemo.java" target="_blank">test code</a>.</pre></div>

 <h4 id="create-hard-coded-query">Create a hard coded query</h4>

 Since <a href="../../../../io/sphere/sdk/queries/Query.html" title="interface in io.sphere.sdk.queries"><code>Query</code></a> is an interface you have the opportunity to code
 a query without the domain specific language:

 <div id="io-sphere-sdk-categories-CategoryByNameQuery%s" class=code-example><button type='button' style='display: none;' class='reveal-imports'>show/hide imports</button><pre class='hide code-example-imports'><code class='java'>import com.fasterxml.jackson.core.type.TypeReference;

import io.sphere.sdk.client.HttpRequestIntent;

import io.sphere.sdk.client.SphereRequestUtils;

import io.sphere.sdk.http.HttpResponse;

import io.sphere.sdk.models.Base;

import io.sphere.sdk.queries.*;

import io.sphere.sdk.http.HttpMethod;

import io.sphere.sdk.json.SphereJsonUtils;

import java.util.Locale;

import static io.sphere.sdk.client.SphereRequestUtils.urlEncode;
</code></pre><pre><code class='java'>public class CategoryByNameQuery extends Base implements Query&lt;Category&gt; {
    private final Locale locale;
    private final String name;

    public CategoryByNameQuery(final Locale locale, final String name) {
        this.locale = locale;
        this.name = name;
    }

    @Override
    public HttpRequestIntent httpRequestIntent() {
        return HttpRequestIntent.of(HttpMethod.GET, "/categories" + urlEncode("name(" + locale.toLanguageTag() + "=\"" + StringQuerySortingModel.escape(name) + "\")"));
    }

    @Override
    public PagedQueryResult&lt;Category&gt; deserialize(final HttpResponse httpResponse) {
        return SphereJsonUtils.readObject(httpResponse.getResponseBody(), new TypeReference&lt;PagedQueryResult&lt;Category&gt;&gt;() {
        });
    }
}
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/categories/CategoryByNameQuery.java" target="_blank">test code</a>.</pre></div>

 <h3 id=predicates>Predicates</h3>

 <h4>Helper methods for common use cases</h4>

 <p>For most common product query use cases, like 'query by slug', helper methods exist as shown in the next example.</p>

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-queryBySlug--%s" class=code-example><pre><code class='java'>final ProductQuery queryBySlug = ProductQuery.of()
        .bySlug(CURRENT, ENGLISH, "blue-t-shirt");
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 You may have noticed that the type of the query is not <a href="../../../../io/sphere/sdk/products/queries/ProductQuery.html" title="interface in io.sphere.sdk.products.queries"><code>ProductQuery</code></a> anymore but <a href="../../../../io/sphere/sdk/queries/QueryDsl.html" title="interface in io.sphere.sdk.queries"><code>QueryDsl</code></a> which does not contain the method <a href="../../../../io/sphere/sdk/products/queries/ProductQuery.html#bySlug-io.sphere.sdk.products.ProductProjectionType-java.util.Locale-java.lang.String-"><code>ProductQuery.bySlug(io.sphere.sdk.products.ProductProjectionType, java.util.Locale, String)</code></a>.
 That is due to the implementation of the domain specific language, but it still enables you to configure pagination and sorting.

 <p>Important to know is that the <a href="../../../../io/sphere/sdk/queries/QueryDsl.html" title="interface in io.sphere.sdk.queries"><code>QueryDsl</code></a> uses immutable objects, so calling <a href="../../../../io/sphere/sdk/products/queries/ProductQuery.html#bySlug-io.sphere.sdk.products.ProductProjectionType-java.util.Locale-java.lang.String-"><code>ProductQuery.bySlug(io.sphere.sdk.products.ProductProjectionType, java.util.Locale, String)</code></a> does not change the internal state of the <a href="../../../../io/sphere/sdk/products/queries/ProductQuery.html" title="interface in io.sphere.sdk.products.queries"><code>ProductQuery</code></a>, but it creates a new <a href="../../../../io/sphere/sdk/queries/QueryDsl.html" title="interface in io.sphere.sdk.queries"><code>QueryDsl</code></a> object with the selected predicate.</p>

 <h4>Self constructed predicates for special cases</h4>

<p>For more advanced queries you have to use the <code>Predicate API</code>. For example, for querying for names you can use:</p>

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-queryByNames--%s" class=code-example><pre><code class='java'>final QueryPredicate&lt;Product&gt; predicate = ProductQueryModel.of().masterData().current().name()
        .lang(ENGLISH).isIn(asList("blue t-shirt", "blue jeans"));
final ProductQuery query = ProductQuery.of().withPredicates(predicate);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 <p>The Predicate API looks verbose, but it prevents you from making typos and it makes the queryable attributes discoverable in your IDE.</p>

 You can still create predicates from strings, but you need to escape characters.

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-testX--%s" class=code-example><pre><code class='java'>final QueryPredicate&lt;Product&gt; safePredicate = ProductQueryModel.of().masterData().current().name()
        .lang(ENGLISH).isIn(asList("blue t-shirt", "blue jeans"));
final QueryPredicate&lt;Product&gt; unsafePredicate =
        QueryPredicate.of("masterData(current(name(en in (\"blue t-shirt\", \"blue jeans\"))))");
assertThat(unsafePredicate).isEqualTo(safePredicate);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 <p>For creating predicates for resource &lt;RESOURCE&gt; there is a method <code>model()</code> in a class &lt;RESOURCE&gt;Query (e.g., Product has ProductQuery).</p>

 <h4>Connecting predicates</h4>

 <p>For connecting predicates use <code>Predicate#and(Predicate)</code> and <code>Predicate#or(Predicate)</code>.</p>


 <p>The following example shows a query for a product where either the name is "foo" <strong><code>or</code></strong> the id is "bar".</p>

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-predicateOrExample--%s" class=code-example><pre><code class='java'>final QueryPredicate&lt;Product&gt; nameIsFoo = ProductQueryModel.of().masterData().current().name()
        .lang(ENGLISH).is("foo");
final QueryPredicate&lt;Product&gt; idIsBar = ProductQueryModel.of().id().is("bar");
final ProductQuery query = ProductQuery.of().withPredicates(nameIsFoo.or(idIsBar));
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 <p>To query for two conditions use the <strong><code>and</code></strong> operator. The following example queries for the name "foo" and the membership in a category with id "cat1".</p>

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-predicateAndExample--%s" class=code-example><pre><code class='java'>final QueryPredicate&lt;Product&gt; nameIsFoo = ProductQueryModel.of().masterData().current().name()
        .lang(ENGLISH).is("foo");
final Reference&lt;Category&gt; cat1 = Category.reference("cat1");
final QueryPredicate&lt;Product&gt; isInCat1 = ProductQueryModel.of().masterData().current()
        .categories().isIn(asList(cat1));
final ProductQuery query = ProductQuery.of().withPredicates(nameIsFoo.and(isInCat1));
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 <p>Since the previous queries have a common path you can combine the two queries in a <strong><code>where</code></strong> clause, like below. This is not supported for every resource, though.</p>

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-predicateAndWithWhereExample--%s" class=code-example><pre><code class='java'>final Reference&lt;Category&gt; cat1 = Category.reference("cat1");
final QueryPredicate&lt;Product&gt; nameIsFooAndIsInCat1 = ProductQueryModel.of().masterData().current()
        .where(cur -&gt; cur.name().lang(ENGLISH).is("foo").and(cur.categories().isIn(asList(cat1))));
final ProductQuery query = ProductQuery.of().withPredicates(nameIsFooAndIsInCat1);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>


 <h4>Negate predicates</h4>

Predicates can be negated by using <a href="../../../../io/sphere/sdk/queries/QueryPredicate.html#negate--"><code>QueryPredicate.negate()</code></a>:

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-predicateNotExample--%s" class=code-example><pre><code class='java'>final QueryPredicate&lt;Product&gt; nameIsFoo = ProductQueryModel.of()
        .masterData().current().name().lang(ENGLISH).is("foo");
final QueryPredicate&lt;Product&gt; nameIsNotFoo = nameIsFoo.negate();
assertThat(nameIsNotFoo).isEqualTo(QueryPredicate.of("not(masterData(current(name(en=\"foo\"))))"));
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 For resources there is also the <code>m.not()</code> method which puts the negation at the beginning of the predicate:
 <div id="io-sphere-sdk-meta-QueryDocumentationTest-notSyntax--%s" class=code-example><pre><code class='java'>final ProductQuery query = ProductQuery.of()
        .withPredicates(m -&gt; m.not(m.masterData().current().name().lang(ENGLISH).is("foo")));
assertThat(query.predicates()).isEqualTo(asList(QueryPredicate.of("not(masterData(current(name(en=\"foo\"))))")));
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id=sorting>Sorting</h3>

 For paginated queries and consistent user visualization it makes sense to sort the search results. If you don't specify the sorting, results can appear in a random order.
 <p>Some implementations sort by ID by default, so even if you forget to specify any sorting options, the order of the results will be constant.</p>

 <p>To specify the sorting use <a href="../../../../io/sphere/sdk/queries/QueryDsl.html#withSort-java.util.List-"><code>QueryDsl.withSort(java.util.List)</code></a>.</p>
 The following example sorts by name in the English locale.

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-sortByName--%s" class=code-example><pre><code class='java'>final QuerySort&lt;Product&gt; byNameAsc = ProductQueryModel.of().masterData().current().name()
        .lang(ENGLISH).sort().asc();
final ProductQuery query = ProductQuery.of().withSort(asList(byNameAsc));
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 You can sort by multiple values, for example, for name sort ascending, and for ID sort descending:

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-sortByNameAscAndIdDesc--%s" class=code-example><pre><code class='java'>final QuerySort&lt;Product&gt; byNameAsc = ProductQueryModel.of().masterData().current().name()
        .lang(ENGLISH).sort().asc();
final QuerySort&lt;Product&gt; byIdDesc = ProductQueryModel.of().id().sort().by(DESC);
final ProductQuery query = ProductQuery.of().withSort(asList(byNameAsc, byIdDesc));
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

Like for predicates, you can traverse the query model tree in the same way to specify a tested and type-safe sort expression. But instead of providing values you use the <code>sort()</code> method.

 <p>If the SDK lacks of a method to create the sort expression, you can still provide it via a string:</p>

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-sortCreationByString--%s" class=code-example><pre><code class='java'>final QuerySort&lt;Product&gt; safeSort = ProductQueryModel.of().masterData().current().name()
        .lang(ENGLISH).sort().asc();
final QuerySort&lt;Product&gt; unsafeSort = QuerySort.of("masterData.current.name.en asc");
assertThat(safeSort).isEqualTo(unsafeSort);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id=pagination>Pagination</h3>

 <p>Assumption: in a product query all products are sorted by ID by default.</p>

 A query might produce more results than you want to consume or the platform lets you consume. At the time of
 writing you can only fetch up to 500 objects at once.

 <p>Imagine you have 15 products:</p>

 <pre> 00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 </pre>

 <p>And following query:</p>

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-queryAllExampleInPaginationContext--%s" class=code-example><pre><code class='java'>final ProductQuery query = ProductQuery.of();
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>

 <p>As long as you do not specify a limitation of how many resources should be fetched with one query
 by <a href="../../../../io/sphere/sdk/queries/QueryDsl.html#withLimit-java.lang.Long-"><code>QueryDsl.withLimit(Long)</code></a>, the platform will deliver up to 20 items so that as a result all (15 products) will be loaded.</p>

 <p>If you specify a limit of 4 to a query as shown below, this query will only load the first 4 products:</p>
 <div id="io-sphere-sdk-meta-QueryDocumentationTest-limitProductQueryTo4--%s" class=code-example><pre><code class='java'>final ProductQuery query = ProductQuery.of().withLimit(4L);
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>
<pre>|00 01 02 03|</pre>


 To load the next 4 products you need to define an offset by <a href="../../../../io/sphere/sdk/queries/QueryDsl.html#withOffset-java.lang.Long-"><code>QueryDsl.withOffset(Long)</code></a>.

 <div id="io-sphere-sdk-meta-QueryDocumentationTest-limitProductQueryTo4PlusOffset4--%s" class=code-example><pre><code class='java'>final ProductQuery queryForFirst4 = ProductQuery.of().withLimit(4L);
final ProductQuery queryForProductId04to07 = queryForFirst4.withOffset(4L);
assertThat(queryForProductId04to07).isEqualTo(ProductQuery.of().withLimit(4L).withOffset(4L));
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-internal-docs/src/test/java/io/sphere/sdk/meta/QueryDocumentationTest.java" target="_blank">test code</a>.</pre></div>
 <pre>|04 05 06 07|</pre>

 To fetch the products with the ID 08 to 11 you need an offset-parameter of 8.
 <p>If you use an offset of 2 and a limit of 4 you will fetch products 02, 03, 04, 05.</p>

 <pre>  00 01|02 03 04 05|06 07 08 09 10 11 12 13 14
 skip 2|limit of 4 | not fetched</pre>

 <p>The fetched result of a query will be a <a href="../../../../io/sphere/sdk/queries/PagedQueryResult.html" title="interface in io.sphere.sdk.queries"><code>PagedQueryResult</code></a>.</p>

 <ul>
 <li><a href="../../../../io/sphere/sdk/queries/PagedQueryResult.html#getResults--"><code>PagedQueryResult.getResults()</code></a> contains all fetched elements.</li>
 <li>The number of fetched elements can be obtained with <code>io.sphere.sdk.queries.PagedQueryResult#size()</code>.</li>
 <li><a href="../../../../io/sphere/sdk/queries/PagedQueryResult.html#getOffset--"><code>PagedQueryResult.getOffset()</code></a> corresponds to the offset of the query.</li>
 <li><a href="../../../../io/sphere/sdk/queries/PagedQueryResult.html#getTotal--"><code>PagedQueryResult.getTotal()</code></a> is the amount of resources matching the query but do not necessarily need to be included in the <a href="../../../../io/sphere/sdk/queries/PagedQueryResult.html" title="interface in io.sphere.sdk.queries"><code>PagedQueryResult</code></a>.</li>
 </ul>

 <p>So, for this example query with offset 2 and limit 4, the <a href="../../../../io/sphere/sdk/queries/PagedQueryResult.html" title="interface in io.sphere.sdk.queries"><code>PagedQueryResult</code></a> will have offset 2, size 4 and total 15. But be careful, count can be smaller than limit in some cases; for example, if total is smaller than the limit (limit 500 but only 15 products). It can also be the case when total is not dividable by limit and the last elements are fetched (.e.g. |12 13 14| with offset 12 and limit 4).</p>

 <h3 id=pagination-for-large-offsets>Pagination for large offsets</h3>

 Using big offsets can slow down the query and has an impact on other requests since the DB is busy with that expensive query.
 See <a href="https://stackoverflow.com/a/7228190">https://stackoverflow.com/a/7228190 for more information.</a>

 <p>For some cases, like iterating through a whole collection for imports/exports the offset parameter can be avoided by using a predicate id &gt; $lastId.</p>

 <div id="io-sphere-sdk-products-queries-QueryAllIntegrationTest%s" class=code-example><button type='button' style='display: none;' class='reveal-imports'>show/hide imports</button><pre class='hide code-example-imports'><code class='java'>import io.sphere.sdk.cartdiscounts.CartDiscountFixtures;

import io.sphere.sdk.models.Identifiable;

import io.sphere.sdk.products.Product;

import io.sphere.sdk.queries.PagedQueryResult;

import io.sphere.sdk.queries.PagedResult;

import org.junit.BeforeClass;

import org.junit.Test;

import java.util.LinkedList;

import java.util.List;

import java.util.concurrent.CompletableFuture;

import java.util.concurrent.CompletionStage;

import static java.util.stream.Collectors.toList;

import static org.assertj.core.api.Assertions.assertThat;
</code></pre><pre><code class='java'>public class QueryAllIntegrationTest extends QueryAllBase {
    //in production code it would higher #smalltestset
    private static final long PAGE_SIZE = 5;

    @BeforeClass
    public static void clean(){
        CartDiscountFixtures.deleteDiscountCodesAndCartDiscounts(client());
    }

    @Test
    public void useIdPredicateInsteadOfOffset() throws Exception {
        final ProductQuery seedQuery = ProductQuery.of()
                //the original predicate, which queries products for a certain product type
                //the idea works also for no predicate to get all products
                .withPredicates(m -&gt; m.productType().is(productType))
                //important, we sort by id, otherwise id &gt; $lastId would not make sense
                .withSort(m -&gt; m.id().sort().asc())
                .withLimit(PAGE_SIZE)
                .withFetchTotal(false);//saves also resources and time
        final CompletionStage&lt;List&lt;Product&gt;&gt; resultStage = findNext(seedQuery, seedQuery, new LinkedList&lt;&gt;());
        final List&lt;Product&gt; actualProducts = resultStage.toCompletableFuture().join();
        assertThat(actualProducts).hasSize(createdProducts.size());
        //!!! the underlying database has a different algorithm to sort by ID, it is a UUID, which differs from String sorting
        final List&lt;Product&gt; javaSortedActual = actualProducts.stream().sorted(BY_ID_COMPARATOR).collect(toList());
        assertThat(javaSortedActual).isEqualTo(createdProducts);
    }

    private CompletionStage&lt;List&lt;Product&gt;&gt; findNext(final ProductQuery seedQuery, final ProductQuery query, final List&lt;Product&gt; products) {
        final CompletionStage&lt;PagedQueryResult&lt;Product&gt;&gt; pageResult = sphereClient().execute(query);
        return pageResult.thenCompose(page -&gt; {
            final List&lt;Product&gt; results = page.getResults();
            products.addAll(results);
            final boolean isLastQueryPage = results.size() &lt; PAGE_SIZE;
            if (isLastQueryPage) {
                return CompletableFuture.completedFuture(products);
            } else {
                final String lastId = getIdForNextQuery(page);
                return findNext(seedQuery, seedQuery
                        .plusPredicates(m -&gt; m.id().isGreaterThan(lastId)), products);
            }
        });
    }

    /**
     * Gets from a {@link PagedResult} the last ID if the result is not the last page.
     * This does only work correctly if it was sorted by ID in ascending order.
     * @param pagedResult the result to extract the id
     * @return the last ID, if present
     */
    private &lt;T extends Identifiable&lt;T&gt;&gt; String getIdForNextQuery(final PagedResult&lt;T&gt; pagedResult) {
        final List&lt;T&gt; results = pagedResult.getResults();
        final int indexLastElement = results.size() - 1;
        return results.get(indexLastElement).getId();
    }
}
</code><p>See the <a href="https://github.com/commercetools/commercetools-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/products/queries/QueryAllIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id=reference-expansion>Reference expansion</h3>

 <a href="../../../../io/sphere/sdk/meta/ReferenceExpansionDocumentation.html" title="class in io.sphere.sdk.meta"><code>The documentation for reference expansion have been moved to ReferenceExpansionDocumentation</code></a> since was also enabled for search and commands.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.io.sphere.sdk.models.Base">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;io.sphere.sdk.models.<a href="../../../../io/sphere/sdk/models/Base.html" title="class in io.sphere.sdk.models">Base</a></h3>
<code><a href="../../../../io/sphere/sdk/models/Base.html#equals-java.lang.Object-">equals</a>, <a href="../../../../io/sphere/sdk/models/Base.html#hashCode--">hashCode</a>, <a href="../../../../io/sphere/sdk/models/Base.html#toString--">toString</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/QueryDocumentation.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../io/sphere/sdk/meta/ProductAttributeDocumentation.html" title="class in io.sphere.sdk.meta"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../io/sphere/sdk/meta/ReferenceExpansionDocumentation.html" title="class in io.sphere.sdk.meta"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?io/sphere/sdk/meta/QueryDocumentation.html" target="_top">Frames</a></li>
<li><a href="QueryDocumentation.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#methods.inherited.from.class.io.sphere.sdk.models.Base">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li>Method</li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css'>                             <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js'></script>                             <script>hljs.initHighlightingOnLoad();</script>                             <script src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js'></script>                             <span id='custom-javascripts'></span>                             <script src='../../../../resources/javascripts/main.js'></script>                             <link rel='stylesheet' href='../../../../resources/stylesheets/main.css'></small></p>
</body>
</html>