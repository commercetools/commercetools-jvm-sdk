<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_73) on Thu Mar 17 19:47:31 CET 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ProductAttributeDocumentation (commercetools JVM SDK 1.0.0-RC4-SNAPSHOT API)</title>
<meta name="date" content="2016-03-17">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ProductAttributeDocumentation (commercetools JVM SDK 1.0.0-RC4-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ProductAttributeDocumentation.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../io/sphere/sdk/meta/JvmSdkFeatures.html" title="class in io.sphere.sdk.meta"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../io/sphere/sdk/meta/QueryDocumentation.html" title="class in io.sphere.sdk.meta"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?io/sphere/sdk/meta/ProductAttributeDocumentation.html" target="_top">Frames</a></li>
<li><a href="ProductAttributeDocumentation.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#methods.inherited.from.class.java.lang.Object">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li>Method</li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.sphere.sdk.meta</div>
<h2 title="Class ProductAttributeDocumentation" class="title">Class ProductAttributeDocumentation</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>io.sphere.sdk.meta.ProductAttributeDocumentation</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public final class <span class="typeNameLabel">ProductAttributeDocumentation</span>
extends <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block"><h3 id="intro">Introduction</h3>
 <h3 id="product-type-creation">ProductType Creation</h3>
 <p>A <a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a> is like a schema that defines how the product attributes are structured.</p>
 <p><a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a>s contain a list of <a href="../../../../io/sphere/sdk/products/attributes/AttributeDefinition.html" title="interface in io.sphere.sdk.products.attributes"><code>AttributeDefinition</code></a>s which corresponds to the name and type of each attribute, along with some additional information".
 Each name/type pair must be unique across a SPHERE.IO project, so if you create an attribute "foo" of type String, you cannot create
 another <a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a> where "foo" has another type (e.g. <a href="../../../../io/sphere/sdk/models/LocalizedString.html" title="class in io.sphere.sdk.models"><code>LocalizedString</code></a>). If you do it anyway you get an error message like:</p>

<pre>"The attribute with name 'foo' has a different type on product type 'exampleproducttype'."</pre>

 <p>In this scenario we provide two <a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a>s <strong>book</strong> and <strong>tshirt</strong>.</p>


 <p>The book product type contains the following attributes:</p>
 <ul>
    <li><code>isbn</code> as <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang"><code>String</code></a>, International Standard Book Number</li>
 </ul>

 <p>The tshirt product type contains the following attributes:</p>

 <ul>
    <li><code>color</code> as <a href="../../../../io/sphere/sdk/models/LocalizedEnumValue.html" title="class in io.sphere.sdk.models"><code>LocalizedEnumValue</code></a> with the colors green and red and their translations in German and English</li>
    <li><code>size</code> as <a href="../../../../io/sphere/sdk/models/EnumValue.html" title="class in io.sphere.sdk.models"><code>EnumValue</code></a> with S, M and X</li>
    <li><code>laundrySymbols</code> as set of <a href="../../../../io/sphere/sdk/models/LocalizedEnumValue.html" title="class in io.sphere.sdk.models"><code>LocalizedEnumValue</code></a> with temperature and tumble drying</li>
    <li><code>matchingProducts</code> as set of product <a href="../../../../io/sphere/sdk/models/Reference.html" title="interface in io.sphere.sdk.models"><code>Reference</code></a>s, which can point to products that are similar to the current product</li>
    <li><code>rrp</code> as <code>MonetaryAmount</code> containing the recommended retail price</li>
    <li><code>availableSince</code> as <a href="http://docs.oracle.com/javase/8/docs/api/java/time/LocalDateTime.html?is-external=true" title="class or interface in java.time"><code>LocalDateTime</code></a> which contains the date since when the product is available for the customer in the shop</li>
 </ul>



 <p>All available attribute types you can find here: <a href="../../../../io/sphere/sdk/products/attributes/AttributeType.html" title="interface in io.sphere.sdk.products.attributes"><code>AttributeType</code></a> in "All Known Implementing Classes".</p>

<p>The code for the creation of the book <a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a>:</p>
 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-createBookProductType--%s" class=code-example><pre><code class='java'>final AttributeDefinition isbn = AttributeDefinitionBuilder
        .of(ISBN_ATTR_NAME, en("ISBN"), StringAttributeType.of())
        .build();

final ProductTypeDraft productTypeDraft = ProductTypeDraft.of(randomKey(), BOOK_PRODUCT_TYPE_NAME, "books", asList(isbn));
final ProductType productType = client().executeBlocking(ProductTypeCreateCommand.of(productTypeDraft));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

<p>The code for the creation of the tshirt <a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a>:</p>
 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-createProductType--%s" class=code-example><pre><code class='java'>final LocalizedEnumValue green = LocalizedEnumValue.of("green",
        LocalizedString.of(ENGLISH, "green").plus(GERMAN, "grün"));
final LocalizedEnumValue red = LocalizedEnumValue.of("red",
        LocalizedString.of(ENGLISH, "red").plus(GERMAN, "rot"));
final AttributeDefinition color = AttributeDefinitionBuilder
        .of(COLOR_ATTR_NAME, en("color"), LocalizedEnumAttributeType.of(red, green))
        .required(true)
        .build();

final EnumValue s = EnumValue.of("S", "S");
final EnumValue m = EnumValue.of("M", "M");
final EnumValue x = EnumValue.of("X", "X");
final AttributeDefinition size = AttributeDefinitionBuilder
        .of(SIZE_ATTR_NAME, en("size"), EnumAttributeType.of(s, m, x))
        .required(true)
        .build();

final LocalizedEnumValue cold = LocalizedEnumValue.of("cold",
        LocalizedString.of(ENGLISH, "Wash at or below 30°C ").plus(GERMAN, "30°C"));
final LocalizedEnumValue hot = LocalizedEnumValue.of("hot",
        LocalizedString.of(ENGLISH, "Wash at or below 60°C ").plus(GERMAN, "60°C"));
final LocalizedEnumValue tumbleDrying = LocalizedEnumValue.of("tumbleDrying",
        LocalizedString.of(ENGLISH, "tumble drying").plus(GERMAN, "Trommeltrocknen"));
final LocalizedEnumValue noTumbleDrying = LocalizedEnumValue.of("noTumbleDrying",
        LocalizedString.of(ENGLISH, "no tumble drying").plus(GERMAN, "Nicht im Trommeltrockner trocknen"));
final SetAttributeType laundryLabelType = SetAttributeType.of(LocalizedEnumAttributeType.of(cold, hot, tumbleDrying, noTumbleDrying));
final AttributeDefinition laundrySymbols = AttributeDefinitionBuilder
        .of(LAUNDRY_SYMBOLS_ATTR_NAME, en("washing labels"), laundryLabelType)
        .build();

final AttributeDefinition matchingProducts = AttributeDefinitionBuilder
        .of(MATCHING_PRODUCTS_ATTR_NAME, en("matching products"), SetAttributeType.of(ReferenceAttributeType.ofProduct()))
        .build();

final AttributeDefinition rrp = AttributeDefinitionBuilder
        .of(RRP_ATTR_NAME, en("recommended retail price"), MoneyAttributeType.of())
        .build();

final AttributeDefinition availableSince = AttributeDefinitionBuilder
        .of(AVAILABLE_SINCE_ATTR_NAME, en("available since"), DateAttributeType.of())
        .build();


final List&lt;AttributeDefinition&gt; attributes = asList(color, size, laundrySymbols,
        matchingProducts, rrp, availableSince);
final ProductTypeDraft productTypeDraft = ProductTypeDraft.of(randomKey(), PRODUCT_TYPE_NAME, "a 'T' shaped cloth", attributes);
final ProductType productType = client().executeBlocking(ProductTypeCreateCommand.of(productTypeDraft));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>



 <p><a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a>s have a key (String)
 which can be used as key to logically identify <a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a>s. The key has an unique constraint.

 <h3 id="product-creation">Product Creation</h3>

 <p>To create a product you need to reference the product type. Since the <a href="../../../../io/sphere/sdk/producttypes/ProductType.html" title="interface in io.sphere.sdk.producttypes"><code>ProductType</code></a>
 ID of the development system will not be the ID of the production system it is necessary to find the product type by name:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-fetchProductTypeByName--%s" class=code-example><pre><code class='java'>final Optional&lt;ProductType&gt; productTypeOptional =
        client().executeBlocking(ProductTypeQuery.of().byName(PRODUCT_TYPE_NAME)).head();
final ProductType productType = productTypeOptional
        .orElseThrow(() -&gt; new RuntimeException("product type " + PRODUCT_TYPE_NAME + " is not present."));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 The simplest way of adding attributes to a <a href="../../../../io/sphere/sdk/products/ProductVariant.html" title="interface in io.sphere.sdk.products"><code>ProductVariant</code></a> is to use
 <a href="../../../../io/sphere/sdk/products/ProductVariantDraftBuilder.html#plusAttribute-java.lang.String-T-"><code>ProductVariantDraftBuilder.plusAttribute(java.lang.String, java.lang.Object)</code></a> which enables you to directly
 put the value of the attribute to the draft. But it cannot check if you put the right objects and types in it.

 <p>A book example:</p>
 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-createBookProduct--%s" class=code-example><pre><code class='java'>final ProductType productType = client().executeBlocking(ProductTypeQuery.of().byName(BOOK_PRODUCT_TYPE_NAME)).head().get();
final ProductVariantDraft masterVariantDraft = ProductVariantDraftBuilder.of()
        .plusAttribute(ISBN_ATTR_NAME, "978-3-86680-192-9")
        .build();
final ProductDraft draft = ProductDraftBuilder
        .of(productType, en("a book"), randomSlug(), masterVariantDraft)
        .build();

final Product product = client().executeBlocking(ProductCreateCommand.of(draft));

final ProductVariant masterVariant = product.getMasterData().getStaged().getMasterVariant();
assertThat(masterVariant.findAttribute(ISBN_ATTR_NAME, AttributeAccess.ofText()))
        .contains("978-3-86680-192-9");
return product;
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>A tshirt example:</p>
 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-createProduct--%s" class=code-example><pre><code class='java'>final ProductType productType = fetchProductTypeByName();
final Reference&lt;Product&gt; similarProductReference = ProductFixtures.referenceableProduct(client()).toReference();
final ProductVariantDraft masterVariantDraft = ProductVariantDraftBuilder.of()
        .plusAttribute(COLOR_ATTR_NAME, "green")//special case: any enums are set with key (String)
        .plusAttribute(SIZE_ATTR_NAME, "S")//special case: any enums are set with key (String)
        .plusAttribute(LAUNDRY_SYMBOLS_ATTR_NAME,
                asSet("cold", "tumbleDrying"))//special case: java.util.Set of any enums is set with java.util.Set of keys (String)
        .plusAttribute(MATCHING_PRODUCTS_ATTR_NAME, asSet(similarProductReference))
        .plusAttribute(RRP_ATTR_NAME, MoneyImpl.of(300, EUR))
        .plusAttribute(AVAILABLE_SINCE_ATTR_NAME, LocalDate.of(2015, 2, 2))
        .build();
final ProductDraft draft = ProductDraftBuilder
        .of(productType, en("basic shirt"), randomSlug(), masterVariantDraft)
        .build();

final Product product = client().executeBlocking(ProductCreateCommand.of(draft));

final ProductVariant masterVariant = product.getMasterData().getStaged().getMasterVariant();
assertThat(masterVariant.findAttribute(COLOR_ATTR_NAME, AttributeAccess.ofLocalizedEnumValue()))
        .overridingErrorMessage("on the get side, the while enum is delivered")
        .contains(LocalizedEnumValue.of("green", LocalizedString.of(ENGLISH, "green").plus(GERMAN, "grün")));
assertThat(masterVariant.findAttribute(SIZE_ATTR_NAME, AttributeAccess.ofEnumValue()))
        .contains(EnumValue.of("S", "S"));
final LocalizedEnumValue cold = LocalizedEnumValue.of("cold",
        LocalizedString.of(ENGLISH, "Wash at or below 30°C ").plus(GERMAN, "30°C"));
final LocalizedEnumValue tumbleDrying = LocalizedEnumValue.of("tumbleDrying",
        LocalizedString.of(ENGLISH, "tumble drying").plus(GERMAN, "Trommeltrocknen"));
assertThat(masterVariant.findAttribute(LAUNDRY_SYMBOLS_ATTR_NAME, AttributeAccess.ofLocalizedEnumValueSet()))
        .contains(asSet(cold, tumbleDrying));
assertThat(masterVariant.findAttribute(MATCHING_PRODUCTS_ATTR_NAME, AttributeAccess.ofProductReferenceSet()))
        .contains(asSet(similarProductReference));
assertThat(masterVariant.findAttribute(RRP_ATTR_NAME, AttributeAccess.ofMoney()))
        .contains(MoneyImpl.of(300, EUR));
assertThat(masterVariant.findAttribute(AVAILABLE_SINCE_ATTR_NAME, AttributeAccess.ofDate()))
        .contains(LocalDate.of(2015, 2, 2));

return product;
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 A wrong value for a field or an invalid type will cause an <a href="../../../../io/sphere/sdk/client/ErrorResponseException.html" title="class in io.sphere.sdk.client"><code>ErrorResponseException</code></a>
 with an error code of <a href="../../../../io/sphere/sdk/models/errors/InvalidField.html#CODE">"InvalidField"</a>.

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-invalidTypeCausesException--%s" class=code-example><pre><code class='java'>final ProductType productType = fetchProductTypeByName();
final ProductVariantDraft masterVariantDraft = ProductVariantDraftBuilder.of()
        .plusAttribute(COLOR_ATTR_NAME, 1)//1 is of illegal type and of illegal key
        .build();
final ProductDraft draft = ProductDraftBuilder
        .of(productType, en("basic shirt"), randomSlug(), masterVariantDraft)
        .build();
assertThatThrownBy(() -&gt; client().executeBlocking(ProductCreateCommand.of(draft)))
        .isInstanceOf(ErrorResponseException.class)
        .matches(e -&gt; ((ErrorResponseException)e).hasErrorCode(InvalidField.CODE));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 As alternative you could declare your attributes at the same place and use these to read and write
 attribute values:

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-productCreationWithGetterSetter--%s" class=code-example><pre><code class='java'>/* the declarations you could put into a separate class */
final NamedAttributeAccess&lt;LocalizedEnumValue&gt; color = AttributeAccess.ofLocalizedEnumValue().ofName(COLOR_ATTR_NAME);
final NamedAttributeAccess&lt;EnumValue&gt; size = AttributeAccess.ofEnumValue().ofName(SIZE_ATTR_NAME);
final NamedAttributeAccess&lt;Set&lt;LocalizedEnumValue&gt;&gt; laundrySymbols =
        AttributeAccess.ofLocalizedEnumValueSet().ofName(LAUNDRY_SYMBOLS_ATTR_NAME);
final NamedAttributeAccess&lt;Set&lt;Reference&lt;Product&gt;&gt;&gt; matchingProducts =
        AttributeAccess.ofProductReferenceSet().ofName(MATCHING_PRODUCTS_ATTR_NAME);
final NamedAttributeAccess&lt;MonetaryAmount&gt; rrp = AttributeAccess.ofMoney().ofName(RRP_ATTR_NAME);
final NamedAttributeAccess&lt;LocalDate&gt; availableSince = AttributeAccess.ofDate().ofName(AVAILABLE_SINCE_ATTR_NAME);

final LocalizedEnumValue cold = LocalizedEnumValue.of("cold",
        LocalizedString.of(ENGLISH, "Wash at or below 30°C ").plus(GERMAN, "30°C"));
final LocalizedEnumValue tumbleDrying = LocalizedEnumValue.of("tumbleDrying",
        LocalizedString.of(ENGLISH, "tumble drying").plus(GERMAN, "Trommeltrocknen"));
final Reference&lt;Product&gt; productReference = ProductFixtures.referenceableProduct(client()).toReference();
final ProductType productType = fetchProductTypeByName();
final ProductVariantDraft masterVariantDraft = ProductVariantDraftBuilder.of()
       /*
           other stuff using the NamedAttributeAccess
           type-safe
        */
        .plusAttribute(color, LocalizedEnumValue.of("green",
                LocalizedString.of(ENGLISH, "green").plus(GERMAN, "grün")))//will extract the key
        .plusAttribute(size, EnumValue.of("S", "S"))
        .plusAttribute(laundrySymbols, asSet(cold, tumbleDrying))//will extract the keys, so you do not need to
                //remember the special cases, there is also no problem mixing the styles
        .plusAttribute(matchingProducts, asSet(productReference))
//        .plusAttribute(matchingProducts, "foobar") won't compile!
        .plusAttribute(rrp, MoneyImpl.of(300, EUR))
        .plusAttribute(availableSince, LocalDate.of(2015, 2, 2))
        .build();
final ProductDraft draft = ProductDraftBuilder
        .of(productType, en("basic shirt"), randomSlug(), masterVariantDraft)
        .build();

final Product product = client().executeBlocking(ProductCreateCommand.of(draft));

final ProductVariant masterVariant = product.getMasterData().getStaged().getMasterVariant();
assertThat(masterVariant.findAttribute(color))
        .contains(LocalizedEnumValue.of("green", LocalizedString.of(ENGLISH, "green").plus(GERMAN, "grün")));
assertThat(masterVariant.findAttribute(size)).contains(EnumValue.of("S", "S"));
assertThat(masterVariant.findAttribute(laundrySymbols)).contains(asSet(cold, tumbleDrying));
assertThat(masterVariant.findAttribute(matchingProducts)).contains(asSet(productReference));
assertThat(masterVariant.findAttribute(rrp)).contains(MoneyImpl.of(300, EUR));
assertThat(masterVariant.findAttribute(availableSince)).contains(LocalDate.of(2015, 2, 2));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>


 <h3 id="attribute-access-without-product-type">Reading Attributes</h3>

 <p>To get a value out of an attribute you need an instance of <a href="../../../../io/sphere/sdk/products/attributes/AttributeAccess.html" title="interface in io.sphere.sdk.products.attributes"><code>AttributeAccess</code></a>
 which keeps the type info to deserialize the attribute.</p>

 <p>You can reuse the <a href="../../../../io/sphere/sdk/products/attributes/NamedAttributeAccess.html" title="interface in io.sphere.sdk.products.attributes"><code>NamedAttributeAccess</code></a> declaration if you want to:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-readAttributeWithoutProductTypeWithNamedAccess--%s" class=code-example><pre><code class='java'>final NamedAttributeAccess&lt;EnumValue&gt; size = AttributeAccess.ofEnumValue().ofName(SIZE_ATTR_NAME);

final ProductVariant masterVariant = createProduct().getMasterData().getStaged().getMasterVariant();

final Optional&lt;EnumValue&gt; attributeOption = masterVariant.findAttribute(size);
assertThat(attributeOption).contains(EnumValue.of("S", "S"));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>Or you can access it on the fly:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-readAttributeWithoutProductTypeWithName--%s" class=code-example><pre><code class='java'>final ProductVariant masterVariant = createProduct().getMasterData().getStaged().getMasterVariant();

final Optional&lt;EnumValue&gt; attributeOption =
        masterVariant.findAttribute(SIZE_ATTR_NAME, AttributeAccess.ofEnumValue());
assertThat(attributeOption).contains(EnumValue.of("S", "S"));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>Or you can access it as <code>JsonNode</code>, for example if you don't know the type or the SDK does not support it yet:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-readAttributeWithoutProductTypeWithJson--%s" class=code-example><pre><code class='java'>final ProductVariant masterVariant = createProduct().getMasterData().getStaged().getMasterVariant();

final Attribute attr = masterVariant.getAttribute(SIZE_ATTR_NAME);
final JsonNode expectedJsonNode = SphereJsonUtils.toJsonNode(EnumValue.of("S", "S"));
assertThat(attr.getValue(AttributeAccess.ofJsonNode())).isEqualTo(expectedJsonNode);
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>


 <p>If the attribute is not present in the <a href="../../../../io/sphere/sdk/products/AttributeContainer.html" title="interface in io.sphere.sdk.products"><code>AttributeContainer</code></a> then the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Optional.html?is-external=true" title="class or interface in java.util"><code>Optional</code></a> will be empty:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-notPresentAttributeRead--%s" class=code-example><pre><code class='java'>final ProductVariant masterVariant = createProduct().getMasterData().getStaged().getMasterVariant();

final Optional&lt;Boolean&gt; attributeOption = masterVariant.findAttribute("notpresent", AttributeAccess.ofBoolean());
assertThat(attributeOption).isEmpty();
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>If you provide a wrong type, the code will throw a <a href="../../../../io/sphere/sdk/json/JsonException.html" title="class in io.sphere.sdk.json"><code>JsonException</code></a>:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-readAttributeWithoutProductTypeWithNamedAccessWithWrongType--%s" class=code-example><pre><code class='java'>final ProductVariant masterVariant = createProduct().getMasterData().getStaged().getMasterVariant();

assertThatThrownBy(() -&gt; masterVariant.findAttribute(SIZE_ATTR_NAME, AttributeAccess.ofBoolean()))
        .isInstanceOf(JsonException.class);
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>



 <h3 id="attribute-table-creation">Creating a table of attributes</h3>

<p>With the help of the product type, you can display a table with attributes. Such as:</p>

 <pre><code>
 color                    | green
 ----------------------------------------------------------------
 size                     | S
 ----------------------------------------------------------------
 matching products        | referenceable product
 ----------------------------------------------------------------
 washing labels           | tumble drying, Wash at or below 30°C
 ----------------------------------------------------------------
 recommended retail price | EUR300.00
 ----------------------------------------------------------------
 available since          | 2015-02-02
 ----------------------------------------------------------------</code></pre>

 <p>In this example the left column is the label of
 the attribute from the product type and the right column is the formatted value from the product:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-showProductAttributeTable--%s" class=code-example><pre><code class='java'>//this serves as whitelist which product attributes should be displayed
//and also in this example it provides a constant order for the attributes to be displayed
final List&lt;String&gt; attrNamesToShow = asList(COLOR_ATTR_NAME, SIZE_ATTR_NAME,
        MATCHING_PRODUCTS_ATTR_NAME, LAUNDRY_SYMBOLS_ATTR_NAME, RRP_ATTR_NAME, AVAILABLE_SINCE_ATTR_NAME);

final Product product = createProduct();
final ProductProjectionQuery query = ProductProjectionQuery.ofStaged()
        .withPredicates(m -&gt; m.id().is(product.getId()))
        .plusExpansionPaths(m -&gt; m.masterVariant().attributes().valueSet())
        .plusExpansionPaths(m -&gt; m.productType());

final ProductProjection productProjection = client().executeBlocking(query).head().get();

final ProductType productType = productProjection.getProductType().getObj();
final ProductVariant masterVariant = productProjection.getMasterVariant();
final List&lt;Attribute&gt; attributes = masterVariant.getAttributes();
final MonetaryAmountFormat moneyFormat = MonetaryFormats.getAmountFormat(US);

final Function&lt;Attribute, Optional&lt;Pair&lt;String, String&gt;&gt;&gt; attributeValueExtractor = attribute -&gt; {
    final Optional&lt;String&gt; extractedResult = AttributeExtraction.&lt;String&gt;of(productType, attribute)
            .ifIs(AttributeAccess.ofLocalizedEnumValue(), v -&gt; v.getLabel().find(ENGLISH).orElse(""))
            .ifIs(AttributeAccess.ofEnumValue(), v -&gt; v.getLabel())
            .ifIs(AttributeAccess.ofLocalizedEnumValueSet(), v -&gt;
                    v.stream()
                            .map(x -&gt; x.getLabel().get(ENGLISH))
                            .filter(x -&gt; x != null)
                            .collect(joining(", ")))
            .ifIs(AttributeAccess.ofProductReferenceSet(), set -&gt; set.stream()
                    .map(productReference -&gt; Optional.ofNullable(productReference.getObj())
                            .map(prod -&gt; prod.getMasterData().getStaged().getName().find(ENGLISH).orElse(""))
                            .orElse(productReference.getId()))
                    .collect(joining(", ")))
            .ifIs(AttributeAccess.ofMoney(), money -&gt; moneyFormat.format(money))
            .ifIs(AttributeAccess.ofDate(), date -&gt; date.toString())
            .findValue();
    final Optional&lt;Pair&lt;String, String&gt;&gt; tableRowData = extractedResult.map(value -&gt; {
        final String label = productType.getAttribute(attribute.getName()).getLabel().get(ENGLISH);
        return ImmutablePair.of(label, value);
    });
    return tableRowData;
};

final List&lt;Pair&lt;String, String&gt;&gt; tableData = attributes.stream()

        .filter(a -&gt; attrNamesToShow.contains(a.getName()))//remove attributes not in whitelist
            //sort so that the order is like in attrNamesToShow
        .sorted(Comparator.comparingInt(a -&gt; attrNamesToShow.indexOf(a.getName())))
        .map(attributeValueExtractor)
        .filter(x -&gt; x.isPresent())
        .map(x -&gt; x.get())
        .collect(toList());


//table column length logic
final List&lt;ImmutablePair&lt;Integer, Integer&gt;&gt; entryLengths = tableData.stream()
        .map(entry -&gt; ImmutablePair.of(entry.getLeft().length(), entry.getRight().length())).collect(toList());
final StringBuilder stringBuilder = new StringBuilder("\n");
final int keyColumnWidth = entryLengths.stream().mapToInt(entry -&gt; entry.getLeft()).max().orElse(1);
final int valueColumnWidth = entryLengths.stream().mapToInt(entry -&gt; entry.getRight()).max().orElse(1);

for (final Pair&lt;String, String&gt; entry : tableData) {
    stringBuilder.append(String.format("%-" + keyColumnWidth + "s", entry.getLeft()))
            .append(" | ")
            .append(String.format("%-" + valueColumnWidth + "s", entry.getRight()))
            .append("\n")
            .append(org.apache.commons.lang3.StringUtils.repeat('-', keyColumnWidth + valueColumnWidth + 3))
            .append("\n");
}
final String table = stringBuilder.toString();
final String expected = "\n" +
        "color                    | green                                \n" +
        "----------------------------------------------------------------\n" +
        "size                     | S                                    \n" +
        "----------------------------------------------------------------\n" +
        "matching products        | referenceable product                \n" +
        "----------------------------------------------------------------\n" +
        "washing labels           | tumble drying, Wash at or below 30°C \n" +
        "----------------------------------------------------------------\n" +
        "recommended retail price | EUR300.00                            \n" +
        "----------------------------------------------------------------\n" +
        "available since          | 2015-02-02                           \n" +
        "----------------------------------------------------------------\n";
assertThat(table).isEqualTo(expected);
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <!-- it is easy to mix uo product and product type with autocomplete and using the non set variant where set is expected -->


 <h3 id="attribute-update">Update attribute values of a product</h3>

<p>Setting attribute values is like a a product creation:</p>


<p>Example for books:</p>
 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-updateAttributesBooks--%s" class=code-example><pre><code class='java'>final Product product = createBookProduct();
final int masterVariantId = 1;

final AttributeDraft attributeDraft = AttributeDraft.of(ISBN_ATTR_NAME, "978-3-86680-192-8");
final SetAttribute updateAction = SetAttribute.of(masterVariantId, attributeDraft);

final Product updatedProduct = client().executeBlocking(ProductUpdateCommand.of(product, updateAction));

final ProductVariant masterVariant = updatedProduct.getMasterData().getStaged().getMasterVariant();
assertThat(masterVariant.findAttribute(ISBN_ATTR_NAME, AttributeAccess.ofText()))
        .contains("978-3-86680-192-8");
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>Example for tshirts:</p>
 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-updateAttributes--%s" class=code-example><pre><code class='java'>final Product product = createProduct();
final int masterVariantId = 1;
final Function&lt;AttributeDraft, SetAttribute&gt; draft = attrDraft -&gt;
        SetAttribute.of(masterVariantId, attrDraft);
final List&lt;SetAttribute&gt; updateActions = asList(
        draft.apply(AttributeDraft.of(COLOR_ATTR_NAME, "red")),//don't forget: enum like =&gt; use only keys
        draft.apply(AttributeDraft.of(SIZE_ATTR_NAME, "M")),
        draft.apply(AttributeDraft.of(LAUNDRY_SYMBOLS_ATTR_NAME, asSet("cold"))),
        draft.apply(AttributeDraft.of(RRP_ATTR_NAME, MoneyImpl.of(20, EUR)))
);

final Product updatedProduct = client().executeBlocking(ProductUpdateCommand.of(product, updateActions));

final ProductVariant masterVariant = updatedProduct.getMasterData().getStaged().getMasterVariant();
assertThat(masterVariant.findAttribute(COLOR_ATTR_NAME, AttributeAccess.ofLocalizedEnumValue()))
        .contains(LocalizedEnumValue.of("red", LocalizedString.of(ENGLISH, "red").plus(GERMAN, "rot")));
assertThat(masterVariant.findAttribute(SIZE_ATTR_NAME, AttributeAccess.ofEnumValue()))
        .contains(EnumValue.of("M", "M"));
final LocalizedEnumValue cold = LocalizedEnumValue.of("cold",
        LocalizedString.of(ENGLISH, "Wash at or below 30°C ").plus(GERMAN, "30°C"));
assertThat(masterVariant.findAttribute(LAUNDRY_SYMBOLS_ATTR_NAME, AttributeAccess.ofLocalizedEnumValueSet()))
        .contains(asSet(cold));
assertThat(masterVariant.findAttribute(RRP_ATTR_NAME, AttributeAccess.ofMoney()))
        .contains(MoneyImpl.of(20, EUR));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 A wrong value for a field or an invalid type (like flat value instead of set) will cause an <a href="../../../../io/sphere/sdk/client/ErrorResponseException.html" title="class in io.sphere.sdk.client"><code>ErrorResponseException</code></a>
 with an error code of <a href="../../../../io/sphere/sdk/models/errors/InvalidField.html#CODE">"InvalidField"</a>.

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-updateWithWrongType--%s" class=code-example><pre><code class='java'>final Product product = createProduct();
assertThatThrownBy(() -&gt; client().executeBlocking(ProductUpdateCommand.of(product,
        SetAttribute.of(1, AttributeDraft.of(LAUNDRY_SYMBOLS_ATTR_NAME, "cold")))))
        .isInstanceOf(ErrorResponseException.class)
        .matches(e -&gt; ((ErrorResponseException)e).hasErrorCode(InvalidField.CODE));
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="attribute-stubs-for-tests">Create attribute stubs for unit tests</h3>

 <p>For unit tests you can create an <a href="../../../../io/sphere/sdk/products/attributes/Attribute.html" title="interface in io.sphere.sdk.products.attributes"><code>Attribute</code></a> with a
 static factory method such as <a href="../../../../io/sphere/sdk/products/attributes/Attribute.html#of-java.lang.String-io.sphere.sdk.products.attributes.AttributeAccess-T-"><code>Attribute.of(String, AttributeAccess, Object)</code></a>:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-attributesForUnitTests--%s" class=code-example><pre><code class='java'>final Product referencedProduct = SphereJsonUtils.readObjectFromResource("product1.json", Product.typeReference());
final Reference&lt;Product&gt; productReference = referencedProduct.toReference();
assertThat(productReference.getObj())
        .overridingErrorMessage("product reference is expanded")
        .isNotNull();
final AttributeAccess&lt;Reference&lt;Product&gt;&gt; access = AttributeAccess.ofProductReference();
final Attribute attribute = Attribute.of("attrname", access, productReference);
assertThat(attribute.getValue(access)).isEqualTo(productReference);
assertThat(attribute.getValue(access).getObj()).isNotNull();
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <h3 id="attributes-in-order-import">Create attributes for importing orders</h3>

 <p>Importing attribute values for orders works different from updating products.
 In orders you provide the full value for enum-like types instead of just the key as done for all other types.
 This makes it possible to create a new enum value on the fly. The other attributes behave as expected.</p>

 <p>Example:</p>

 <div id="io-sphere-sdk-attributestutorial-ProductTypeCreationDemoIntegrationTest-orderImportExample--%s" class=code-example><pre><code class='java'>final Product product = createProduct();
//yellow is not defined in the product type, but for order imports this works to add use it on the fly
final LocalizedEnumValue yellow =
        LocalizedEnumValue.of("yellow", LocalizedString.of(ENGLISH, "yellow").plus(GERMAN, "gelb"));
final ProductVariantImportDraft productVariantImportDraft = ProductVariantImportDraftBuilder.of(product.getId(), 1)
        .attributes(
                AttributeImportDraft.of(COLOR_ATTR_NAME, yellow),
                AttributeImportDraft.of(RRP_ATTR_NAME, EURO_30)
        ).build();
final LineItemImportDraft lineItemImportDraft =
        LineItemImportDraftBuilder.of(productVariantImportDraft, 1L, Price.of(EURO_30), en("product name"))
        .build();
final OrderImportDraft orderImportDraft = OrderImportDraftBuilder
        .ofLineItems(EURO_20, OrderState.COMPLETE, asList(lineItemImportDraft))
        .build();

final Order order = client().executeBlocking(OrderImportCommand.of(orderImportDraft));

final ProductVariant productVariant = order.getLineItems().get(0).getVariant();
final Optional&lt;LocalizedEnumValue&gt; colorAttribute =
        productVariant.findAttribute(COLOR_ATTR_NAME, AttributeAccess.ofLocalizedEnumValue());
assertThat(colorAttribute).contains(yellow);
final Optional&lt;MonetaryAmount&gt; rrpAttribute =
        productVariant.findAttribute(RRP_ATTR_NAME, AttributeAccess.ofMoney());
assertThat(rrpAttribute).contains(EURO_30);
final Set&lt;String&gt; presentAttributes = productVariant.getAttributes().stream()
        .map(attr -&gt; attr.getName())
        .collect(toSet());
assertThat(presentAttributes).containsOnly(COLOR_ATTR_NAME, RRP_ATTR_NAME);
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/attributestutorial/ProductTypeCreationDemoIntegrationTest.java" target="_blank">test code</a>.</pre></div>



<h3 id="attribute-class-semantics">Semantics of the Attribute classes</h3>

 <table>
    <caption>attribute properties</caption>
    <tr>
        <th></th><th><a href="../../../../io/sphere/sdk/products/attributes/Attribute.html" title="interface in io.sphere.sdk.products.attributes"><code>Attribute</code></a></th><th><a href="../../../../io/sphere/sdk/products/attributes/AttributeDraft.html" title="interface in io.sphere.sdk.products.attributes"><code>AttributeDraft</code></a></th><th><a href="../../../../io/sphere/sdk/products/attributes/AttributeImportDraft.html" title="interface in io.sphere.sdk.products.attributes"><code>AttributeImportDraft</code></a></th>
    </tr>
 <tr> <td>purpose</td>    <td>read access</td>    <td>write product, create product</td>    <td>order import</td></tr>
 <tr> <td>reference expansion</td>    <td>keeps expanded references</td>    <td>no expansion</td>    <td>no expansion</td></tr>
 <tr> <td>enum shape</td>    <td>full enum</td>    <td>enum key (String)</td>    <td>full enum</td></tr>
 <tr> <td>value constraints</td>    <td>value in product type</td>    <td>value in product type</td>    <td>free, create on the fly</td></tr>
 </table>

 <h3 id="nested-attributes">Nested attributes (experimental)</h3>

 <p>This feature is experimental.</p>
 <p>An example:</p>

 <div id="io-sphere-sdk-producttypes-NestedAttributeIntegrationTest%s" class=code-example><button type='button' style='display: none;' class='reveal-imports'>show/hide imports</button><pre class='hide code-example-imports'><code class='java'>import io.sphere.sdk.products.attributes.*;
import io.sphere.sdk.models.Referenceable;
import io.sphere.sdk.products.*;
import io.sphere.sdk.test.IntegrationTest;
import org.junit.Test;
import java.util.*;
import static io.sphere.sdk.products.ProductFixtures.withProduct;
import static io.sphere.sdk.producttypes.ProductTypeFixtures.withProductType;
import static io.sphere.sdk.utils.SphereInternalUtils.asSet;
import static java.util.Arrays.asList;
import static org.assertj.core.api.Assertions.assertThat;
import static io.sphere.sdk.test.SphereTestUtils.*;
import static java.util.stream.Collectors.toList;
</code></pre><pre><code class='java'>public final class NestedAttributeIntegrationTest extends IntegrationTest {

    static class NutrientInfo {
        static NamedAttributeAccess&lt;String&gt; quantityContainedUOM = AttributeAccess.ofString().ofName("quantityContainedUOM");
        static NamedAttributeAccess&lt;Double&gt; quantityContained = AttributeAccess.ofDouble().ofName("quantityContained");
        static NamedAttributeAccess&lt;String&gt; measurementPrecision = AttributeAccess.ofString().ofName("measurementPrecision");
        static NamedAttributeAccess&lt;String&gt; nutrientTypeCode = AttributeAccess.ofString().ofName("nutrientTypeCode");
    }

    static class Nutrient {
        static NamedAttributeAccess&lt;String&gt; servingSizeUOM = AttributeAccess.ofString().ofName("servingSizeUOM");
        static NamedAttributeAccess&lt;Double&gt; servingSize = AttributeAccess.ofDouble().ofName("servingSize");
        static NamedAttributeAccess&lt;Set&lt;AttributeContainer&gt;&gt; nutrientInformation = AttributeAccess.ofNestedSet().ofName("nutrientInformation");
    }

    static class Banana {
        static NamedAttributeAccess&lt;String&gt; bananaColor = AttributeAccess.ofString().ofName("bananaColor");
        static NamedAttributeAccess&lt;Set&lt;AttributeContainer&gt;&gt; nutrients = AttributeAccess.ofNestedSet().ofName("nutrients");
    }

    @Test
    public void itShouldBePossibleToDeeplyNestNestedTypesInsideOfSetTypes() throws Exception {
        withProductType(client(), () -&gt; createNutrientInformation(), nutrientInformationType -&gt; {
            withProductType(client(), () -&gt; createNutrient(nutrientInformationType), nutrientType -&gt; {
                withProductType(client(), () -&gt; createBanana(nutrientType), bananaType -&gt; {
                    final ProductDraftBuilder productDraftBuilder = ProductDraftBuilder
                            .of(bananaType, en("Super Banana!"), en(slugify("super-banana")), createBananaVariant())
                            .description(en("Cool and refreshing blue banana!"));

                    withProduct(client(), productDraftBuilder, product -&gt; {
                        final AttributeContainer attrs = product.getMasterData().getStaged().getMasterVariant();

                        assertThat(attrs.findAttribute(Banana.bananaColor)).contains("blue");
                        assertThat(attrs.findAttribute(Banana.nutrients).map(Set::size)).contains(2);

                        final List&lt;AttributeContainer&gt; nutrients = getSortedNutrients(attrs);

                        assertNutrient(nutrients.get(0), 0.05D, "KM", 1);
                        assertNutrientInfo(getNutrientInfos(nutrients.get(0)).get(0), "FIBTG", "PRECISE", 1.3D, "GR");

                        assertNutrient(nutrients.get(1), 1.5D, "M", 2);
                        assertNutrientInfo(getNutrientInfos(nutrients.get(1)).get(0), "FAT", "APPROXIMATELY", 0.06D, "KG");
                        assertNutrientInfo(getNutrientInfos(nutrients.get(1)).get(1), "FIBTG", "APPROXIMATELY", 3.8D, "GR");
                    });
                });
            });
        });
    }

    private List&lt;AttributeContainer&gt; getSortedNutrients(final AttributeContainer banana) {
        return banana.findAttribute(Banana.nutrients).get().stream()
                .sorted((c1, c2) -&gt; c1.findAttribute(Nutrient.servingSize).get().compareTo(c2.findAttribute(Nutrient.servingSize).get()))
                .collect(toList());
    }

    private List&lt;AttributeContainer&gt; getNutrientInfos(final AttributeContainer nutrient) {
        return nutrient.findAttribute(Nutrient.nutrientInformation).get().stream()
                .sorted((c1, c2) -&gt; c1.findAttribute(NutrientInfo.nutrientTypeCode).get().compareTo(c2.findAttribute(NutrientInfo.nutrientTypeCode).get()))
                .collect(toList());
    }

    private void assertNutrient(final AttributeContainer nutrient, final double servingSize,
                                final String servingSizeUOM, final int nutrientInformationSize) {
        assertThat(nutrient.findAttribute(Nutrient.servingSize)).contains(servingSize);
        assertThat(nutrient.findAttribute(Nutrient.servingSizeUOM)).contains(servingSizeUOM);
        assertThat(nutrient.findAttribute(Nutrient.nutrientInformation).map(Set::size)).contains(nutrientInformationSize);
    }

    private void assertNutrientInfo(final AttributeContainer nutrientInfo, final String nutrientTypeCode,
                                    final String measurementPrecision, final double quantityContained,
                                    final String quantityContainedUOM) {
        assertThat(nutrientInfo.findAttribute(NutrientInfo.nutrientTypeCode)).contains(nutrientTypeCode);
        assertThat(nutrientInfo.findAttribute(NutrientInfo.measurementPrecision)).contains(measurementPrecision);
        assertThat(nutrientInfo.findAttribute(NutrientInfo.quantityContained)).contains(quantityContained);
        assertThat(nutrientInfo.findAttribute(NutrientInfo.quantityContainedUOM)).contains(quantityContainedUOM);
    }

    private ProductVariantDraft createBananaVariant() {
        return ProductVariantDraftBuilder.of()
                .plusAttribute(Banana.bananaColor.draftOf("blue"))
                .plusAttribute(Banana.nutrients.draftOf(asSet(AttributeContainerDraft.of(asList(
                        Nutrient.servingSize.draftOf(1.5D),
                        Nutrient.servingSizeUOM.draftOf("M"),
                        Nutrient.nutrientInformation.draftOf(asSet(AttributeContainerDraft.of(
                                NutrientInfo.nutrientTypeCode.draftOf("FIBTG"),
                                NutrientInfo.measurementPrecision.draftOf("APPROXIMATELY"),
                                NutrientInfo.quantityContained.draftOf(3.8D),
                                NutrientInfo.quantityContainedUOM.draftOf("GR")
                        ), AttributeContainerDraft.of(
                                NutrientInfo.nutrientTypeCode.draftOf("FAT"),
                                NutrientInfo.measurementPrecision.draftOf("APPROXIMATELY"),
                                NutrientInfo.quantityContained.draftOf(0.06D),
                                NutrientInfo.quantityContainedUOM.draftOf("KG")
                        )))
                )), AttributeContainerDraft.of(asList(
                        Nutrient.servingSize.draftOf(0.05D),
                        Nutrient.servingSizeUOM.draftOf("KM"),
                        Nutrient.nutrientInformation.draftOf(asSet(AttributeContainerDraft.of(asList(
                                NutrientInfo.nutrientTypeCode.draftOf("FIBTG"),
                                NutrientInfo.measurementPrecision.draftOf("PRECISE"),
                                NutrientInfo.quantityContained.draftOf(1.3D),
                                NutrientInfo.quantityContainedUOM.draftOf("GR")
                        ))))
                )))))
                .sku(randomKey())
                .build();
    }

    private ProductTypeDraft createNutrientInformation() {
        return ProductTypeDraft.of(randomKey(), "NutrientInformation", "NutrientInformation", asList(
                        AttributeDefinitionBuilder.of(NutrientInfo.quantityContainedUOM.getName(),
                                en(NutrientInfo.quantityContainedUOM.getName()), StringAttributeType.of()).build(),
                        AttributeDefinitionBuilder.of(NutrientInfo.quantityContained.getName(),
                                en(NutrientInfo.quantityContained.getName()), NumberAttributeType.of()).build(),
                        AttributeDefinitionBuilder.of(NutrientInfo.measurementPrecision.getName(),
                                en(NutrientInfo.measurementPrecision.getName()), StringAttributeType.of()).build(),
                        AttributeDefinitionBuilder.of(NutrientInfo.nutrientTypeCode.getName(),
                                en(NutrientInfo.nutrientTypeCode.getName()), StringAttributeType.of()).build()));
    }

    private ProductTypeDraft createNutrient(final Referenceable&lt;ProductType&gt; nutrientInformationType) {
        return ProductTypeDraft.of(randomKey(), "Nutrient", "Nutrient", asList(
                        AttributeDefinitionBuilder.of(Nutrient.servingSizeUOM.getName(),
                                en(Nutrient.servingSizeUOM.getName()), StringAttributeType.of()).build(),
                        AttributeDefinitionBuilder.of(Nutrient.servingSize.getName(),
                                en(Nutrient.servingSize.getName()), NumberAttributeType.of()).build(),
                        AttributeDefinitionBuilder.of(Nutrient.nutrientInformation.getName(),
                                en(Nutrient.nutrientInformation.getName()), SetAttributeType.of(NestedAttributeType.of(nutrientInformationType))).searchable(false).build()));
    }

    private ProductTypeDraft createBanana(Referenceable&lt;ProductType&gt; nutrientType) {
        return ProductTypeDraft.of(randomKey(), "Banana", "Banana", asList(
                        AttributeDefinitionBuilder.of(Banana.bananaColor.getName(),
                                en(Banana.bananaColor.getName()), StringAttributeType.of()).build(),
                        AttributeDefinitionBuilder.of(Banana.nutrients.getName(),
                                en(Banana.nutrients.getName()), SetAttributeType.of(NestedAttributeType.of(nutrientType))).searchable(false).build()));
    }
}
</code><p>See the <a href="https://github.com/sphereio/sphere-jvm-sdk/blob/master/commercetools-models/src/test/java/io/sphere/sdk/producttypes/NestedAttributeIntegrationTest.java" target="_blank">test code</a>.</pre></div>

 <p>A general explanation can be found in the  <a href="http://dev.sphere.io/tutorials-nested-types.html">HTTP API tutorial</a>.</p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ProductAttributeDocumentation.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../io/sphere/sdk/meta/JvmSdkFeatures.html" title="class in io.sphere.sdk.meta"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../io/sphere/sdk/meta/QueryDocumentation.html" title="class in io.sphere.sdk.meta"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?io/sphere/sdk/meta/ProductAttributeDocumentation.html" target="_top">Frames</a></li>
<li><a href="ProductAttributeDocumentation.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#methods.inherited.from.class.java.lang.Object">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li>Method</li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css'>                             <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js'></script>                             <script>hljs.initHighlightingOnLoad();</script>                             <script src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js'></script>                             <span id='custom-javascripts'></span>                             <script src='../../../../resources/javascripts/main.js'></script>                             <link rel='stylesheet' href='../../../../resources/stylesheets/main.css'></small></p>
</body>
</html>